```
whois megacorpone.com -h <dnsip>
```

- google
```
site:megacorp.com intext:test
intitle:"index of" "parent directory"
```
- netcraft - https://sitereport.netcraft.com/?url=http://www.megacorpone.com
- gitrob/gitleaks
- shodan - google for devices - Kali
```
hostname:megacorpone.com
```
- security scan
	- https://securityheaders.com/
	- https://www.ssllabs.com/ssltest/

### DNS enumeration
```
host www.megacorpone.com
host -t txt megacorpone.com
host -t mx megacorpone.com - lowest priority(10) is used
```

#### get wordlists from seclists
```
sudo apt install seclists
/usr/share/seclists
`for ip in $(cat list.txt); do host $ip.megacorpone.com; done
for ip in $(seq 200 254); do host 51.222.169.$ip; done | grep -v "not found"
```

#### kali DNS tools - dnsrecon, DNSenum
```
dnsrecon -d megacorpone.com -t std
dnsrecon -d megacorpone.com -D ~/list.txt -t brt
dnsenum megacorpone.com
```

connect to windows 11 box
```
rdesktop 192.168.224.152:3389
nslookup -type=TXT info.megacorptwo.com 192.168.217.154
```

### port scanning

IP tables - monitor traffic generated by nmap
```
sudo iptables -I INPUT 1 -s 192.168.50.149 -j ACCEPT
sudo iptables -I OUTPUT 1 -d 192.168.50.149 -j ACCEPT
sudo iptables -Z
```

after running nmap, look at traffic from iptables
```
sudo iptables -vn -L
```

zero packet and byte counters
```
sudo iptables -Z
```

```
nc -nvv -w 1 -z 192.168.226.151 0-3390
nc -nv -u -z -w 1 192.168.226.151 100-200
```

nmap SYN scan
```
sudo nmap -sS 192.168.50.149
```

connect scan
```
nmap -sT 192.168.50.149
```

UDP scan
```
sudo nmap -sU 192.168.50.149
```

network sweep (-sn)
```
nmap -sn 192.168.50.1-253
```

save output
```
nmap -v -sn 192.168.50.1-253 -oG ping-sweep.txt
grep Up ping-sweep.txt | cut -d " " -f 2
```

target specific ports
```
nmap -p 80 192.168.50.1-253 -oG web-sweep.txt
grep open web-sweep.txt | cut -d" " -f2
```

scan multiple ips for top ports
```
nmap -sT -A --top-ports=20 192.168.50.1-253 -oG top-port-sweep.txt
```

top ports determined by `/usr/share/nmap/nmap-services`

guess target's OS
```
sudo nmap -O 192.168.50.14 --osscan-guess
```

once OS is known, inspect service banners
```
nmap -sT -A 192.168.50.14
```

nmap scripting engine - launch scanning attacks - /usr/share/nmap/scripts
```
nmap --script http-headers 192.168.50.6
```

get script help
```
nmap --script-help http-headers
```

# windows
```
Test-NetConnection -Port 445 192.168.50.151
1..1024 | % {echo ((New-Object Net.Sockets.TcpClient).Connect("192.168.50.151", $_)) "TCP port $_ is open"} 2>$null
```

```
nmap -sS 192.168.226.1-253 -oG scan.txt
grep Up scan.txt | cut -d " " -f 2
grep 25/open scan.txt
```

```
nmap -sT -p 43 192.168.226.1-253 -oG scan2.txt

rdesktop 192.168.226.152:3389

1..1024 | % {echo ((New-Object Net.Sockets.TcpClient).Connect("192.168.226.151", $_)) "TCP port $_ is open"} 2>$null

Test-NetConnection -Port 445 192.168.226.151

nmap --script-help http-title
sudo nmap --script http-title 192.168.217.1-253
```

### SMB
```
sudo nmap -v -p 139,445 -oG smb.txt 192.168.217.1-254
cat smb.txt
```

get netBIOS information
```
sudo nbtscan -r 192.168.50.0/24
```

SMB scripts
```
ls -1 /usr/share/nmap/scripts/smb*
```

windows 11
```
nmap -v -p 139,445 --script smb-os-discovery 192.168.50.152
net view \\dc01 /all
rdesktop 192.168.229.152:3389
```

doesn't seem to list shares
```
nmap -p 445 --script smb-enum-shares 192.168.217.13
```

actually lists shares
```
smbclient -L 192.168.217.13
```

### smtp
```
nmap -p 25 192.168.217.6-152
telnet 192.168.217.8 25
> VRFY root
```

### SNMP - network protocol (udp)
```
sudo nmap -sU --open -p 161 192.168.217.1-254 -oG open-snmp.txt
```

brute force IPs
```
echo public > community
echo private >> community
echo manager >> community
for ip in $(seq 1 254); do echo 192.168.217.$ip; done > ips
onesixtyone -c community -i ips
#snmpwalk
snmpwalk -c public -v1 -t 10 192.168.50.151
```

enumerate users on a windows host
```
snmpwalk -c public -v1 192.168.50.151 1.3.6.1.4.1.77.1.2.25
```

enumerate currently running processes
```
snmpwalk -c public -v1 192.168.217.151 1.3.6.1.2.1.25.4.2.1.2
```

list all tcp listening ports
```
snmpwalk -c public -v1 192.168.50.151 1.3.6.1.2.1.6.13.1.3
```

```
nmap 192.168.229.151 -p 10000-65535
sudo nmap -sS -A 192.168.229.8 -p 30000-65535

1..1024 | % {echo ((New-Object Net.Sockets.TcpClient).Connect("192.168.229.151", $_)) "TCP port $_ is open"} 2>$null
53,88,135,139
```









